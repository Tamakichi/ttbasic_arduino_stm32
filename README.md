## è±Šå››å­£ã‚¿ã‚¤ãƒ‹ãƒ¼BASIC for Arduino STM32V0.86Î²

ï¼ˆæ³¨æ„ï¼‰  
ã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆã‹ã‚‰ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†ã‚’åˆ‡ã‚Šé›¢ã—ã¾ã—ãŸã€‚  
V0.85Î²ç‰ˆã¾ã§ã¯ã€ä¸‹è¨˜ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚  
Tamakichi/ttbasic_arduino  https://github.com/Tamakichi/ttbasic_arduino  

![ã‚µãƒ³ãƒ—ãƒ«ç”»åƒ](./image/03.jpg)  ![ã‚µãƒ³ãƒ—ãƒ«ç”»åƒ](./image/10.jpg) ![ã‚µãƒ³ãƒ—ãƒ«ç”»åƒ](./image/11.jpg)  

æœ¬ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€ä¸‹è¨˜ã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆã‚’[Arduino STM32](https://github.com/rogerclarkmelbourne/Arduino_STM32) å‘ã‘ã«ç§»æ¤ãƒ»æ©Ÿèƒ½æ‹¡å¼µç‰ˆã§ã™.  
- ã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆé…å¸ƒã‚µã‚¤ãƒˆ  
   https://github.com/vintagechips/ttbasic_arduino  
    é–¢é€£æƒ…å ± [é›»è„³ä¼èª¬ Vintagechips - è±Šå››å­£ã‚¿ã‚¤ãƒ‹ãƒ¼BASICç¢ºå®šç‰ˆ](https://vintagechips.wordpress.com/2015/12/06/%E8%B1%8A%E5%9B%9B%E5%AD%A3%E3%82%BF%E3%82%A4%E3%83%8B%E3%83%BCbasic%E7%A2%BA%E5%AE%9A%E7%89%88/)

### è‘—ä½œæ¨©ã«ã¤ã„ã¦

**ã€Œè±Šå››å­£ Tiny BASICã€**ã®è‘—ä½œæ¨©ã¯é–‹ç™ºè€…**ã®Tetsuya Suzuki**æ°ã«ã‚ã‚Šã¾ã™.  
ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆ©ç”¨ã«ã¤ã„ã¦ã¯ã€ã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆã®è‘—ä½œæ¨©è€…ã®é…å¸ƒæ¡ä»¶ã«å¾“ã†ã‚‚ã®ã¨ã—ã¾ã™.  
è‘—ä½œæ¨©è€…ã®åŒæ„ãªã—ã«çµŒæ¸ˆçš„ãªåˆ©ç›Šã‚’å¾—ã¦ã¯ã„ã‘ã¾ã›ã‚“.  
ã“ã®æ¡ä»¶ã®ã‚‚ã¨ã§ã€åˆ©ç”¨ã€è¤‡å†™ã€æ”¹ç·¨ã€å†é…å¸ƒã‚’èªã‚ã¾ã™.    

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ
![ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³](./image/04.png) Â 

#### æ§‹æˆçµ„ã¿åˆã‚ã›ãƒ‘ã‚¿ãƒ¼ãƒ³

ä¸Šè¨˜æ§‹æˆã§è¡¨ç¤ºæ©Ÿå™¨ã¯æ’ä»–é¸æŠã¨ãªã‚Šã¾ã™ã€‚æ¬¡ã®æ§‹æˆæ§‹æˆã«ã¦ã‚·ã‚¹ãƒ†ãƒ ã‚’çµ„ã‚€ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ 

![æ§‹æˆãƒ‘ã‚¿ãƒ¼ãƒ³](./image/04_1.png)  

##### åŸºæœ¬ï¼”æ§‹æˆã®çµç·šå›³

Blue Pillãƒœãƒ¼ãƒ‰ã‚’åˆ©ç”¨ã—ãŸå ´åˆã®ä¸Šè¨˜â‘ ï½â‘£ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸçµç·šå›³ã‚’ç¤ºã—ã¾ã™ã€‚  
åœ§é›»ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚å¿…è¦ã«å¿œã˜ã¦æ¥ç¶šã—ã¦ä¸‹ã•ã„ã€‚  
RTCç”¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é›»æ± ã€SDã‚«ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚‚å¿…è¦ã«å¿œã˜ã¦è¿½åŠ ã§ãã¾ã™ã€‚ Â 

###### â‘ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç‰ˆ

![ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç‰ˆ](./image/04_2.png) 

###### â‘¡NTSCç‰ˆ

![NTSCç‰ˆ](./image/04_3.png)  

###### â‘¢OLEDç‰ˆ

**(1)OLED I2Cã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ç‰ˆ**

![NTSCç‰ˆ](./image/04_4.png) 

**(2)OLED SPIã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ç‰ˆ**

![NTSCç‰ˆ](./image/04_5.png) 

â‘£TFT(ILI9341 320x240ãƒ‰ãƒƒãƒˆ)ç‰ˆ

![NTSCç‰ˆ](./image/04_6.png) 

##### SDã‚«ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³

![SDã‚«ãƒ¼ãƒ‰](./image/02_2.png)  
â€»5Vãƒ»3.3Vå¤‰æ›ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒä¹—ã£ã¦ã„ã‚‹è£½å“ã®å ´åˆã€VCCã¯5Vã‚’ä¾›çµ¦ã—ãªã„ã¨å‹•ä½œã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

##### RTCç”¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é›»æ±   ã‚ªãƒ—ã‚·ãƒ§ãƒ³

![RTCç”¨é›»æ± ](./image/02_1.png) Â 

#### ãƒ”ãƒ³åˆ©ç”¨æ§‹æˆ  

![ãƒ”ãƒ³å‰²ã‚Šä»˜ã‘](./image/05.png)  

#### ãƒœãƒ¼ãƒˆä¸Šã®ãƒ”ãƒ³ä¸€è¦§

![ãƒ”ãƒ³å‰²ã‚Šä»˜ã‘](./image/03_4.png) 

#### åˆ©ç”¨å¯èƒ½å¸‚è²©ãƒ‘ãƒ¼ãƒ„

- PS/2ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ç”¨ã‚³ãƒã‚¯ã‚¿  
  â—¾aitendo PS/2ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« [ML-PS2-4P] http://www.aitendo.com/product/11377  
  â—¾ç§‹æœˆé›»å­ USBã‚³ãƒã‚¯ã‚¿DIPåŒ–ã‚­ãƒƒãƒˆ(Aãƒ¡ã‚¹) http://akizukidenshi.com/catalog/g/gK-07429/  

- NTSCç”¨ RCAã‚³ãƒã‚¯ã‚¿  
  â—¾aitendo TVOUTãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ [K-TVOUT2R] http://www.aitendo.com/product/11740  
  â—¾aitendo RCAãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ [brebo.jam.rca] http://www.aitendo.com/product/12125  
  â—¾ç§‹æœˆé›»å­ RCAã‚¸ãƒ£ãƒƒã‚¯DIPåŒ–ã‚­ãƒƒãƒˆ(é»„) http://akizukidenshi.com/catalog/g/gK-06522/  
  â€»aitendoè£½å“ã¯ä»˜å±æŠµæŠ—ã‚’ä½¿ã†ã¨è‹¥å¹²å‡ºåŠ›é›»åœ§ãŒä¸ŠãŒã‚Šã¾ã™ãŒã€è¨±å®¹ç¯„å›²ã§ã™ã€‚

- SDã‚«ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«  
  amazon  
  â—¾[EasyWordMall SDã‚«ãƒ¼ãƒ‰ã‚¹ãƒ­ãƒƒãƒˆã‚½ã‚±ãƒƒãƒˆãƒªãƒ¼ãƒ€ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«Arduinoç”¨](https://www.amazon.co.jp/EasyWordMall-SD%E3%82%AB%E3%83%BC%E3%83%89%E3%82%B9%E3%83%AD%E3%83%83%E3%83%88%E3%82%BD%E3%82%B1%E3%83%83%E3%83%88%E3%83%AA%E3%83%BC%E3%83%80%E3%83%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%ABArduino%E7%94%A8/dp/B010PZZXNI/ref=cm_wl_huc_item)  
  â—¾[Rasbee Micro SD/ TF ã‚«ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚·ãƒ¼ãƒ«ãƒ‰ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« SPIã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ 1å€‹](https://www.amazon.co.jp/Rasbee-Micro-%E3%82%AB%E3%83%BC%E3%83%89%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%B7%E3%83%BC%E3%83%AB%E3%83%89-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB-SPI%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9/dp/B01KZBD6OA/ref=cm_wl_huc_item)  
  â—¾[KKHMF ãƒã‚¤ã‚¯ãƒ­SDã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒœãƒ¼ãƒ‰ã€€TFã‚«ãƒ¼ãƒ‰ã‚·ãƒ¼ãƒ«ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€€SPIã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ Mega Due](https://www.amazon.co.jp/KKHMF-%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%ADSD%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%E3%83%9C%E3%83%BC%E3%83%89-TF%E3%82%AB%E3%83%BC%E3%83%89%E3%82%B7%E3%83%BC%E3%83%AB%E3%83%89%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB-SPI%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9-Mega-Due/dp/B01G5AZ882/ref=cm_wl_huc_item)  
  â—¾[Arduinoã®ãŸã‚ã®ãƒã‚¤ã‚¯ãƒ­SDã‚«ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«](https://www.amazon.co.jp/GeeBot-Arduino%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%ADSD%E3%82%AB%E3%83%BC%E3%83%89%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB/dp/B01GX126BU/ref=cm_wl_huc_item)  

![SDã‚«ãƒ¼ãƒ‰](./image/12.jpg)  

- OLEDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«(128x64ãƒ‰ãƒƒãƒˆ)  
  SSD1306ã€SSD1309ã€SH1106ã®ï¼“ã¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«å¯¾å¿œ  
  I2Cã€SPIã«å¯¾å¿œã€ã‚µã‚¤ã‚ºã¯1.3ã‚¤ãƒ³ãƒä»¥ä¸Šã‚’æ¨å¥¨  
  Aliexpress  
  â—¾[1PCS 1.3" OLED module white color SPI 128X64 1.3 inch OLED](https://www.aliexpress.com/item/1PCS-1-3-OLED-module-white-color-SPI-128X64-1-3-inch-OLED-LCD-LED-Display/32681602908.html?spm=a2g0s.9042311.0.0.vs8i3e)  
  â—¾[1PCS 1.3" OLED module white color I2C128X64 1.3 inch OLED](https://www.aliexpress.com/item/1PCS-1-3-OLED-module-white-color-128X64-1-3-inch-OLED-LCD-LED-Display-Module/32683739839.html?spm=a2g0s.9042311.0.0.vs8i3e)  

![OLED](./image/13.jpg) 

- TFT(ILI9341)ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«  
  320x240ãƒ‰ãƒƒãƒˆ SPIæ¥ç¶š  
  amazon  
  â—¾[HiLetgo 2.8 "TFT LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ ã‚¿ãƒƒãƒãƒ‘ãƒãƒ« SPIã‚·ãƒªã‚¢ãƒ«240 * 320 ILI9341 5V / 3.3V](https://www.amazon.co.jp/HiLetgo-LCD%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4-%E3%82%BF%E3%83%83%E3%83%81%E3%83%91%E3%83%8D%E3%83%AB-SPI%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB240-ILI9341/dp/B072N551V3/ref=cm_wl_huc_item)  
  â—¾[ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ŒSODIAL(R)2.2" TFT LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŸºæ¿](https://www.amazon.co.jp/%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%83%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%EF%BC%8CSODIAL-LCD%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%83%BC%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E5%9F%BA%E6%9D%BF-240x320-ILI9341-PIC%E3%81%AE%E3%81%9F%E3%82%81-%E8%B5%A4/dp/B01DXBI3I8/ref=cm_wl_huc_item)  

![TFT](./image/14.jpg) 


### æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ»å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»é…ç½®
#### æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨é…ç½®
ä¸‹è¨˜ã®ãƒªãƒ³ã‚¯ã‚ˆã‚Šç›´æ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è§£å‡ã€ã¾ãŸã¯gitã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¸‹ã•ã„ã€‚  

* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯  
  https://github.com/Tamakichi/ttbasic_arduino_stm32/archive/master.zip

* gitã‚’ä½¿ã£ãŸãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰(è¤‡è£½ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰)  
   ```
   git clone https://github.com/Tamakichi/ttbasic_arduino_stm32.git
   ```
  Windows 10ã¸ã®gitã®å°å…¥ã¯ã€ä¸‹è¨˜ã®æ‰‹é †ã‚’å‚è€ƒã«ã—ã¦ä¸‹ã•ã„ã€‚  
  * [git for Windowsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †](./docs/install_git.html)

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸæœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã‚’ ğŸ“ttbasic_arduino_stm32\ ã¨ã—ã¾ã™ã€‚  
ï¼ˆè§£å‡ç›´å¾Œã® *tbasic_arduino_stm32-master* ã‹ã‚‰å¤‰æ›´ã—ã¦ä¸‹ã•ã„)  
ãƒˆãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä»»æ„ã®å ´æ‰€ã«é…ç½®ã—ã¦ä¸‹ã•ã„ã€‚  

#### æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ§‹æˆ
ğŸ“ttbasic_arduino_stm32\  ãƒ»ãƒ»ãƒ»ãƒ» æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€  
ã€€ğŸ“bin\  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã‚¹ã‚±ãƒƒãƒ(ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢)  
ã€€ğŸ“docs\  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¡(ä½œæˆä¸­)  
ã€€ğŸ“hardware\    ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é…ç½®å ´æ‰€  
ã€€ğŸ“libraries\   ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ã‚¹ã‚±ãƒƒãƒç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª  
ã€€ğŸ“ttbasic\  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ã‚¹ã‚±ãƒƒãƒæœ¬ä½“  
ã€€ğŸ“„manual.pdf  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ãƒãƒ‹ãƒ¥ã‚¢ãƒ«(æ—§)    
ã€€ğŸ“„platform.local.txt  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³å®šç¾©(OLEDã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©æŒ‡å®šç”¨)  
ã€€ğŸ“„README.md    ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ  
ã€€ğŸ“„TinyBASICæ—©è¦‹è¡¨.pdf  ãƒ»ãƒ»ãƒ»ãƒ»ãƒ»ãƒ» ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ(æ—§)  

Arduino IDEã§ã‚¹ã‚±ãƒƒãƒã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹å ´åˆã¯ã€  
Arduino IDEã®ç’°å¢ƒè¨­å®šã® **ã‚¹ã‚±ãƒƒãƒãƒ–ãƒƒã‚¯ã®ä¿å­˜å ´æ‰€** ã« ğŸ“ttbasic_arduino_stm32\ ã‚’
è¨­å®šã—ã¦ä¸‹ã•ã„ã€‚  
ã“ã‚Œã«ã‚ˆã‚Šã€æ—¢å­˜ã®ç’°å¢ƒãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®å¹²æ¸‰æ¸›ã‚‰ã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚  

#### Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨é…ç½®
Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€éšæ™‚æ›´æ–°ã•ã‚Œã¦ã„ã‚‹ãŸã‚å‹•ä½œç¢ºèªã—ãŸæ™‚ç‚¹ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã«  
ä¸å…·åˆä¿®æ­£ã‚’è¡Œã£ãŸã€ä¸‹è¨˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦åˆ©ç”¨ã—ã¦ä¸‹ã•ã„ã€‚  

* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯  
  https://github.com/Tamakichi/Arduino_STM32/archive/master.zip

* gitã‚’ä½¿ã£ãŸãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰(è¤‡è£½ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰)  
   ```
   git clone https://github.com/Tamakichi/Arduino_STM32.git
   ```

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸArduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã‚’ ğŸ“Arduino_STM32\ ã¨ã—ã¾ã™ã€‚  
ï¼ˆè§£å‡ç›´å¾Œã® *Arduino_STM32-master* ã‹ã‚‰å¤‰æ›´ã—ã¦ä¸‹ã•ã„)  

Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€ã¯ã€ğŸ“hardware\ã®ä¸‹ã«é…ç½®ã—ã¦ä¸‹ã•ã„ã€‚    
ã€€ğŸ“ttbasic_arduino_stm32\  
ã€€ã€€ğŸ“hardware\  
ã€€ã€€ã€€ğŸ“Arduino_STM32\

#### STM32ç”¨USBãƒ‰ãƒ©ã‚¤ãƒã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«(Windows10ç’°å¢ƒ)
Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«æ·»ä»˜ã®USBãƒ‰ãƒ©ã‚¤ãƒã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  

ä¸‹è¨˜ã®ğŸ“win\ğŸ“„install_drivers.basã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ‰ãƒ©ã‚¤ãƒã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚    
ã€€ğŸ“ttbasic_arduino_stm32\  
ã€€ã€€ğŸ“hardware\  
ã€€ã€€ã€€ğŸ“Arduino_STM32\  
ã€€ã€€ã€€ã€€ğŸ“drivers\  
ã€€ã€€ã€€ã€€ã€€ğŸ“win\  
ã€€ã€€ã€€ã€€ã€€ã€€ğŸ“„install_drivers.bas

#### Java(JRE)å®Ÿè¡Œç’°å¢ƒã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Arduino STM32ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒœãƒ¼ãƒˆæ›¸ãè¾¼ã¿ãƒ„ãƒ¼ãƒ«ã¯Javaã®å®Ÿè¡Œç’°å¢ƒãŒå¿…è¦ã§ã™ã€‚  
Javaã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„å ´åˆã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¸‹ã•ã„ã€‚  
* ç„¡æ–™Javaã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ https://java.com/ja/download/

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã‚¹ã‚±ãƒƒãƒ(ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢) ã®åˆ©ç”¨
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ã‚¹ã‚±ãƒƒãƒ(ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢) ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚  
ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ç›´æ¥ãƒã‚¤ã‚³ãƒ³ãƒœãƒ¼ãƒ‰ã«æ›¸ãè¾¼ã‚“ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚  

ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢æ›¸è¾¼ã¿æ‰‹é †(Windows 10ã®å ´åˆ)  
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®**binãƒ•ã‚©ãƒ«ãƒ€**ã«ï¼’ã¤ã®ã‚¿ã‚¤ãƒ—ã®ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚

1. ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç„¡ã—ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢(ãƒã‚¤ãƒŠãƒªãƒ¼å½¢å¼)  
ğŸ“ttbasic_arduino_stm32\  
ã€€ğŸ“bin\  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_NTSC.bin	(NTSCãƒ“ãƒ‡ã‚ªå‡ºåŠ›ç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_OLED_SH1106_I2C.bin	(OLED SH1106 I2Cç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_OLED_SH1106_SPI.bin	(OLED SH1106 SPIç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_OLED_SSD1306_I2C.bin (OLEDSSD1306/SSD1309 I2Cç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_OLED_SSD1306_SPI.bin (OLED SSD1306/SSD1309 SPIç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_Serial.bin (ã‚·ãƒªã‚¢ãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç‰ˆ)  
ã€€ã€€ğŸ“„black_medium_small_square:ttbasic_TFT.bin	(TFT ILI9341ç‰ˆ) Â 

2. ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢(ãƒã‚¤ãƒŠãƒªãƒ¼å½¢å¼)  
ğŸ“ttbasic_arduino_stm32\  
ã€€ğŸ“bin\PlusBootloader\  
ã€€ã€€ğŸ“„boot_ttbasic_NTSC.bin	(NTSCãƒ“ãƒ‡ã‚ªå‡ºåŠ›ç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_OLED_SH1106_I2C.bin (OLED SH1106 I2Cç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_OLED_SH1106_SPI.bin (OLED SH1106 SPIç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_OLED_SSD1306_I2C.bin (OLED SSD1306/SSD1309 I2Cç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_OLED_SSD1306_SPI.bin (OLED SSD1306/SSD1309 SPIç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_Serial.bin	(ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç‰ˆ)  
ã€€ã€€ğŸ“„boot_ttbasic_TFT.bin (TFT ILI9341ç‰ˆ)  

#### ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç„¡ã—ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢(ãƒã‚¤ãƒŠãƒªãƒ¼å½¢å¼)ã®æ›¸è¾¼ã¿æ‰‹é †(Windows10ç’°å¢ƒ)
åˆ©ç”¨ã™ã‚‹ãƒã‚¤ã‚³ãƒ³ãƒœãƒ¼ãƒ‰ã«Arduino STM32ç”¨ã®ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ãŒæ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  
BluePillãƒœãƒ¼ãƒ‰ã¸ã®æ›¸ãè¾¼ã¿ã¯ä¸‹è¨˜ã®è¨˜äº‹ç­‰ã‚’å‚è€ƒã—ã¦è¡Œã£ã¦ä¸‹ã•ã„ã€‚  

* [BluePillãƒœãƒ¼ãƒ‰ã¸ã®ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã®æ›¸ãè¾¼ã¿(æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ·»ä»˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)](./docs/install.html#_bluepillãƒœãƒ¼ãƒ‰ã¸ã®ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã®æ›¸ãè¾¼ã¿)
* DEKOã®ã‚¢ãƒ¤ã‚·ã„ãŠéƒ¨å±‹-ã€ŒSTM32F103C8T6ã€http://ht-deko.com/arduino/stm32f103c8t6.html Â 

##### ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢æ›¸è¾¼ã¿æ‰‹é †
1. `ttwrite.bat`ã®ä¿®æ­£  
   ```
   set dev=COM4
   ãƒ»ãƒ»ãƒ»
   ```
   `dev`ã«ãƒã‚¤ã‚³ãƒ³ãƒœãƒ¼ãƒ‰ã®USBãƒãƒ¼ãƒˆãŒåˆ©ç”¨ã™ã‚‹ã‚·ãƒªã‚¢ãƒ«ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚  
   `COM`ã¯å¿…ãšåŠè§’å¤§æ–‡å­—ã§è¨˜è¿°ã—ã¦ä¸‹ã•ã„ã€‚  

2. ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸Šã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ  
   ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’èµ·å‹•ã—ã¾ã™ã€‚  
   ğŸ“ttbasic_arduino_stm32\ğŸ“bin\ ã«ç§»å‹•ã—ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  

   ```
   ttwrite ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç„¡ã—ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«
   ```
    æŒ‡å®šã™ã‚‹ **ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç„¡ã—ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«** ã¯å„è‡ªã®åˆ©ç”¨ç›®çš„ã«å¿œã˜ã¦ã§é¸æŠã—ã¦ä¸‹ã•ã„ã€‚  

   `ttwrite ttbasic_TFT.bin`ã‚’å®Ÿè¡Œã—ãŸä¾‹ï¼š  
   ```
   ttwrite ttwrite ttbasic_TFT.bin
   ```

   ![ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](./image/09.png) Â 

   ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã—ã¦ã‚‚æ›¸ãè¾¼ã¿ãŒé–‹å§‹ã•ã‚Œãªã„å ´åˆã€ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã“ã¨ã§ã€  
   ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ãŒå¼·åˆ¶çš„ã«æ›¸è¾¼ã¿ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚è©¦ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚  


   åˆ¥ã®æ–¹æ³•ã¨ã—ã¦ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ä¸Šã§`ttwrite.bat`ã‚¢ã‚¤ã‚³ãƒ³ä¸Šã«**ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ç„¡ã—ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«**ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ‰ãƒ©ãƒƒã‚¯ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§æ›¸ãè¾¼ã‚€ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚  

   ![ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—](./image/15.png)   

#### ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢(ãƒã‚¤ãƒŠãƒªãƒ¼å½¢å¼) ã®æ›¸è¾¼ã¿æ‰‹é †

ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ã¨åŒã˜æ–¹æ³•ã§æ›¸ãè¾¼ã‚€ã“ã¨å‡ºæ¥ã¾ã™ã€‚  
(ãƒ—ãƒ­ã‚°ãƒ©ãƒST-LINKã®ã‚’ä½¿ã£ã¦ã€STM32 ST-LINK Utilityã§æ›¸ãè¾¼ã¿)  

ã“ã“ã§ã¯æ·»ä»˜ã®ttbtwrite.batã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ãŸã‚·ãƒªã‚¢ãƒ«æ¥ç¶šã«ã‚ˆã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚  

##### äº‹å‰æº–å‚™
![ã‚·ãƒªã‚¢ãƒ«æ¥ç¶š](./image/16.jpg) 

1. USB-ã‚·ãƒªã‚¢ãƒ«å¤‰æ›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨æ„ã—ã¦ä¸‹ã•ã„ã€‚  
  ãƒ‘ã‚½ã‚³ãƒ³ã«æ¥ç¶šã—ã¦æ¥ç¶šã™ã‚‹ã‚·ãƒªã‚¢ãƒ«ãƒãƒ¼ãƒˆã‚’ç¢ºèªã—ã¾ã™ã€‚  
  ã“ã“ã§ã¯ã€COM5ã¨ã—ã¾ã™ã€‚

2. æ·»ä»˜ã®æ›¸è¾¼ã¿ç”¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ttbtwrite.batã‚’å„è‡ªã®ç’°å¢ƒã«åˆã‚ã›ã¦ä¿®æ­£ã—ã¾ã™ã€‚  
ğŸ“bin\PlusBootloader\  
ã€€ğŸ“„stm32flash.exe ãƒ»ãƒ» stm32flash(Arduino STM32ã«ä»˜å±ã®ã‚‚ã¨ã®åŒã˜ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã™)  
ã€€ğŸ“„ttbtwrite.bat   ãƒ»ãƒ»ãƒ» æ›¸è¾¼ã¿ç”¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«  

   ```
   set dev=COM5
   stm32flash.exe -b 115200 -f -v -w %1 %dev%
   ```
   devã®ã‚·ãƒªã‚¢ãƒ«ãƒãƒ¼ãƒˆã®æŒ‡å®šã‚’å„è‡ªã®ç’°å¢ƒã«åˆã‚ã›ã¦å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  

3. BluePillãƒœãƒ¼ãƒ‰ã®USBãƒãƒ¼ãƒˆã‚’é›»æºä¾›çµ¦ã‚’å…¼ã­ã¦ãƒ‘ã‚½ã‚³ãƒ³ã«æ¥ç¶šã—ã¾ã™ã€‚  
4. USB-ã‚·ãƒªã‚¢ãƒ«å¤‰æ›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨Blue Pillãƒœãƒ¼ãƒ‰çµç·šã—ã¾ã™ã€‚  ã€€

   | USB-ã‚·ãƒªã‚¢ãƒ«å¤‰æ›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | Blue Pillãƒœãƒ¼ãƒ‰ |
   | :-------------: | :----------: |
   |       GND       |     GND      |
   |       TXD       |     A10      |
   |       RXD       |      A9      |

5. ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼ã‚¹ã‚¤ãƒƒãƒã®è¨­å®šãƒœãƒ¼ãƒ‰ä¸Šã®BOOT0ã‚¸ãƒ£ãƒ³ãƒ‘ã‚’1ã«è¨­å®šã—ã¾ã™ã€‚  
   ![ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](./image/17.jpg)   
   **BOOT0**ï¼š1  
   **BOOT1**ï¼š0  

##### æ›¸è¾¼ã¿ä½œæ¥­
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  
**ttbtwrite.bat**ã®ã‚ã‚‹ğŸ“bin\PlusBootloader\ ã«ç§»å‹•ã—ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  
```
ttbtwrite ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«
```
**ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«**ã¯åŒã˜ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã‚ã‚Šã¾ã™ã€‚  
å„è‡ªã®ç”¨é€”ã«åˆã‚ã›ã¦æŒ‡å®šã—ã¦ä¸‹ã•ã„ã€‚  

`ttbtwrite boot_ttbasic_Serial.bin` ã‚’å®Ÿè¡Œã—ãŸä¾‹ï¼š  
```
ttbtwrite ttbtwrite boot_ttbasic_Serial.bin
```
![ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](./image/18.png) 

æ›¸è¾¼ã¿ã¯ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ä¸Šã§**ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«**ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’**ttbtwrite.bat**ã®ã‚¢ã‚¤ã‚³ãƒ³ã«ãƒ‰ãƒ©ãƒƒã‚¯ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹æ“ä½œã§ã‚‚è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚  
![ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](./image/19.png)   

æ›¸è¾¼ã¿ãŒå®Œäº†ã—ãŸã‚‰ã€BOOT0ã‚¸ãƒ£ãƒ³ãƒã‚’0ã«æˆ»ã—ã¦ä¸‹ã•ã„ã€‚  

### ã‚¹ã‚±ãƒƒãƒã®æ›¸è¾¼ã¿æ‰‹é †
ã‚¹ã‚±ãƒƒãƒã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦æ›¸ãè¾¼ã‚€å ´åˆã®æ‰‹é †ã§ã™ã€‚  
ã‚¹ã‚±ãƒƒãƒã¯ä¸‹è¨˜ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ttbasic.inoãŒæœ¬ä½“ã§ã™ã€‚      
ã€€ğŸ“ttbasic_arduino_stm32\
ã€€ã€€ğŸ“ttbasic\
ã€€ã€€ã€€ğŸ“„ttbasic.ino

#### äº‹å‰æº–å‚™
1. Arduino IDEã®ã‚¹ã‚±ãƒƒãƒä¿å­˜å ´æ‰€ã®è¨­å®š  
  Arduino IDEã®ç’°å¢ƒè¨­å®šã® **ã‚¹ã‚±ãƒƒãƒãƒ–ãƒƒã‚¯ã®ä¿å­˜å ´æ‰€** ã« 
  ğŸ“ttbasic_arduino_stm32\ ã‚’è¨­å®šã—ã¦ä¸‹ã•ã„ã€‚  
  è¨­å®šåæ˜ ã®ãŸã‚ä¸€æ—¦Arduino IDEçµ‚äº†ã—ã€å†åº¦Arduino IDEã‚’èµ·å‹•ã—ã¦ä¸‹ã•ã„ã€‚

2. Arduino IDEã®ãƒœãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ã«ã¦  
ã€ŒArduino SAMD Boards (32-bits ARM Coetex-M0+) by Arduinoã€ã®  
æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¸‹ã•ã„ã€‚

3. Arduino IDEã®ãƒœãƒ¼ãƒ‰ã®è¨­å®š  
Arduinoã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ãƒœãƒ¼ãƒ‰ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚  
    * ãƒœãƒ¼ãƒ‰ï¼š Generic STM32F103C series  
    * Variantï¼š Generic STM32F103C8(20k RAM 128k Flash)  
    * Upload methodï¼š STM32duino bootloader  
    * CPU Speedï¼š 72MHz
    * Optimizeï¼š Smallest
    * Upload method: "STM32duino bootloader" â€»å„è‡ªç’°å¢ƒã«åˆã‚ã›ã¦ä»»æ„ Â 
    * ã‚·ãƒªã‚¢ãƒ«ãƒãƒ¼ãƒˆ: â€»å„è‡ªç’°å¢ƒã«åˆã‚ã›ã¦ä»»æ„ Â 

4. STM32ç”¨USBãƒ‰ãƒ©ã‚¤ãƒã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

ä¸Šè¨˜ã®è¨­å®šã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ·»ä»˜ã®ä¸‹è¨˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚å‚ç…§ä¸‹ã•ã„ã€‚
* [Arduino IDEã®ç’°å¢ƒè¨­å®š](./docs/install.html#_arduino_ide%E3%81%AE%E7%92%B0%E5%A2%83%E8%A8%AD%E5%AE%9A)

#### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆåˆ¥ã®ä¿®æ­£

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€**åŸºæœ¬4æ§‹æˆã®â‘¡NTSCç‰ˆ(SDã‚«ãƒ¼ãƒ‰ã‚ã‚Š)ã®è¨­å®š**ã¨ãªã£ã¦ã„ã¾ã™ã€‚  
ç•°ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã§åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€ãã‚Œãã‚Œã«å¿…è¦ãªä¿®æ­£ã‚’è¡Œã£ã¦ä¸‹ã•ã„ã€‚

##### â‘ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç‰ˆ
1. `tconfig.h`ã®ä¿®æ­£
- ` USE_SCREEN_MODE`ã®å€¤`1`ã‚’`0`ã«å¤‰æ›´ã—ã¦ä¸‹ã•ã„.
  ```
  #define USE_SCREEN_MODE 0 //â€»ãƒ‡ãƒã‚¤ã‚¹ã‚¹ã‚¯ãƒªãƒ¼ãƒ³åˆ©ç”¨ã®å ´åˆã€1ã‚’æŒ‡å®šã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:1)
  ```
- `USE_NTSC`ã®å€¤`1`ã‚’`0`ã«å¤‰æ›´ã—ã¦ä¸‹ã•ã„.
  ```
  #define USE_NTSC  1  // 0:åˆ©ç”¨ã—ãªã„ 1:åˆ©ç”¨ã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:1)
  ```

##### â‘¡OLEDç‰ˆ
1. `tconfig.h`ã®ä¿®æ­£
- `USE_NTSC`ã®å€¤`1`ã‚’`0`ã«å¤‰æ›´ã—ã¦ä¸‹ã•ã„.  
  ````
  #define USE_NTSC  0  // 0:åˆ©ç”¨ã—ãªã„ 1:åˆ©ç”¨ã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:1)
  ````
 - `USE_OLED`ã®å€¤`0`ã‚’`1`ã«å¤‰æ›´ã—ã¦ä¸‹ã•ã„.  
   `OLED_IFMODE`ã®å€¤ã‚’I2Cæ¥ç¶šã®å ´åˆ`0`ã€SPIæ¥ç¶šã®å ´åˆ`1`ã‚’æŒ‡å®šã—ã¦ä¸‹ã•ã„.  
   å¿…è¦ã«å¿œã˜ã¦ã€ç”»é¢ã®å‘ã`OLED_RTMODE`ã‚’å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  

     ````cpp
   #define USE_OLED     1 // 0:åˆ©ç”¨ã—ãªã„ 1:åˆ©ç”¨ã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:0)
                         // åˆ©ç”¨æ™‚ã¯ USE_NTSC ã‚’0ã«ã™ã‚‹ã“ã¨
   #define OLED_IFMODE 1 // OLEDæ¥ç¶šãƒ¢ãƒ¼ãƒ‰(0:I2C 1:SPI ãƒ‡ã‚ªãƒ•ã‚©ãƒ«ãƒˆ:1 )
   #define OLED_SCMODE 1 // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒ¢ãƒ¼ãƒ‰(1ï½6 ãƒ‡ã‚ªãƒ•ã‚©ãƒ«ãƒˆ:1 )
   #define OLED_RTMODE 0 // ç”»é¢ã®å‘ã (0ï½3: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0)
     ````

2. **ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®é¸æŠ**  
   ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€SH1106 å¯¾å¿œã¨ãªã£ã¦ã„ã¾ã™ã€‚  
   åˆ©ç”¨ã™ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’SSD1306/SSD1309ã«å¤‰æ›´ã™ã‚‹å ´åˆã€  
   åˆ©ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  
   ã“ã®åˆ‡ã‚Šæ›¿ãˆã¯ã€Arduinoã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¡ä»¶æŒ‡å®šã‚’è¡Œã† **platform.local.txt**
   ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦æŒ‡å®šã—ã¾ã™ã€‚

   æœ¬ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ·»ä»˜ã®  **platform.local.txt** ãƒ•ã‚¡ã‚¤ãƒ«   
  ğŸ“ttbasic_arduino_stm32\   
  ã€€ğŸ“„platform.local.txt

   ã‚’ä¸‹è¨˜ã®ãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ã—ã¦ä¸‹ã•ã„(STM32F1ã®ä¸‹)  
  ğŸ“ttbasic_arduino_stm32\  
  ã€€ğŸ“hardware\  
  ã€€ã€€ğŸ“Arduino_STM32\  
  ã€€ã€€ã€€ğŸ“STM32F1\  
  ã€€ã€€ã€€ã€€ğŸ“„platform.local.txt
  
    **platform.local.txt** ã¯æ¬¡ã®ã‚ˆã†ãªå®šç¾©ã¨ãªã£ã¦ã„ã¾ã™ã€‚  
     ```TXT
    # These can be overridden in platform.local.txt
    # OLED_DEV: 0 SH1106ã€ 1 SSD1306/SSD1309
    compiler.c.extra_flags=-DOLED_DEV=1
    compiler.cpp.extra_flags=-DOLED_DEV=1
     ```
    OLED_DEVã®å€¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã‚‚SH1106ã€SSD1306/SSD1309ã®åˆ‡ã‚Šæ›¿ãˆã‚’è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚  

##### â‘¢TFT(ILI9341 320x240ãƒ‰ãƒƒãƒˆ)ç‰ˆ  
1. `tconfig.h`ã®ä¿®æ­£  
  `USE_NTSC`ã®å€¤`1`ã‚’`0`ã«å¤‰æ›´ã—ã¦ä¸‹ã•ã„.  
      ```cpp
    #define USE_NTSC  0  // 0:åˆ©ç”¨ã—ãªã„ 1:åˆ©ç”¨ã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:1)
      ```

    `USE_TFT`ã®å€¤`0`ã‚’`1`ã«ä¿®æ­£ã—ã¦ä¸‹ã•ã„.  
    å¿…è¦ã«å¿œã˜ã¦ã€ç”»é¢ã®å‘ã`TFT_RTMODE`ã‚’å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  

    ```CPP
    #define USE_TFT     1 // 0:åˆ©ç”¨ã—ãªã„ 1:åˆ©ç”¨ã™ã‚‹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ:0)
                          // åˆ©ç”¨æ™‚ã¯ USE_NTSC ã‚’0ã«ã™ã‚‹ã“ã¨
    #define TFT_SCMODE 1  // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒ¢ãƒ¼ãƒ‰(1ï½6 ãƒ‡ã‚ªãƒ•ã‚©ãƒ«ãƒˆ:1 )
    #define TFT_RTMODE 3  // ç”»é¢ã®å‘ã (0ï½3: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3)
    ```

#### ã‚¹ã‚±ãƒƒãƒã®æ›¸è¾¼ã¿
Arduno IDEã®ã€Œâ‡’ã€ã‚¢ã‚¤ã‚³ãƒ³ã¾ãŸã¯ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ [ã‚¹ã‚±ãƒƒãƒ] > [ãƒã‚¤ã‚³ãƒ³ãƒœãƒ¼ãƒ‰ã«æ›¸ãè¾¼ã‚€]ã«ã¦  
ã‚¹ã‚±ãƒƒãƒã‚’æ›¸ãè¾¼ã¿ã¾ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
#### ãƒœãƒ¼ãƒ‰ä¸Šã®LEDã®ç‚¹æ»…  
```
10 P=PC13
20 GPIO P,OUTPUT
30 OUT P,HIGH
40 FOR I=1 TO 10
50 OUT P,LOW
60 WAIT 300
70 OUT P,HIGH
80 WAIT 300
90 NEXT I
```

#### ã‚¢ãƒŠãƒ­ã‚°å€¤è¡¨ç¤º
```
10 CLS
20 GPIO PB1,ANALOG
30 A=ANA(PB1)
40 LOCATE 5,5: ? A; "     "
50 GOTO 30
```
#### é…åˆ—ã®é€£ç¶šè¨­å®š
```
10 @(1)=1,2,3,4,5,6,7,8
20 FOR I=1 TO 8
30 ? "@(";I;")=";@(I)
40 NEXT I
```

#### ã‚·ãƒ•ãƒˆæ¼”ç®—
```
10 A=1
20 FOR I=0 TO 16
30 ? HEX$(A<<I,4)
40 NEXT I
```

#### ãƒ©ãƒ™ãƒ«ã®åˆ©ç”¨
```
100 GOSUB "SUB01"
110 GOSUB "SUB02"
120 N=0
130 "LOOP"
140 PRINT "N=";N
150 N=N+1:IF N<5 GOTO "LOOP"
160 END
170 "SUB01"
180 PRINT "SUB01"
190 RETURN
200 "SUB02"
210 PRINT "SUB02"
220 RETURN
```

## ä»¥é™ã¯ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã™



TOYOSHIKI Tiny BASIC for Arduino

The code tested in Arduino Uno R3.<br>
Use UART terminal, or temporarily use Arduino IDE serial monitor.

Operation example

&gt; list<br>
10 FOR I=2 TO -2 STEP -1; GOSUB 100; NEXT I<br>
20 STOP<br>
100 REM Subroutine<br>
110 PRINT ABS(I); RETURN

OK<br>
&gt;run<br>
2<br>
1<br>
0<br>
1<br>
2

OK<br>
&gt;

The grammar is the same as<br>
PALO ALTO TinyBASIC by Li-Chen Wang<br>
Except 3 point to show below.

(1)The contracted form of the description is invalid.

(2)Force abort key<br>
PALO ALTO TinyBASIC -> [Ctrl]+[C]<br>
TOYOSHIKI TinyBASIC -> [ESC]<br>
NOTE: Probably, there is no input means in serial monitor.

(3)Other some beyond my expectations.

(C)2012 Tetsuya Suzuki<br>

